// -*- javascript -*-

// --------------------------------------------------------------------------------
// insertarPersona
// --------------------------------------------------------------------------------

// --------------------------------------------------------------------------------
// --------------------------------------------------------------------------------
module.exports = {

	conexion: null,  // conexión con la bd. Se "inyecta" al cargarse.

	// tengo "inyectada" también this.logica para poder llamar a funciones "hermanas"
	//         this.logica.funciones.loQueSea.f()

	// ----------------------------------------------------------------------------
	// datos:{dni:Texto, nombre:Texto: apellidos:Texto}
	//     --> 
	//         insertarPersona() -->
	// ----------------------------------------------------------------------------
	f: async function ( datos ) {

		var textoSQL =
			'insert into Persona values( $dni, $nombre, $apellidos );'
		var valoresParaSQL = { $dni: datos.dni, $nombre: datos.nombre,
							   $apellidos: datos.apellidos }
		
		return new Promise( (resolver, rechazar) => {
			this.conexion.run( textoSQL, valoresParaSQL, function( err ) {
				( err ? rechazar(err) : resolver() )
			})
		})
		
	} // ()

} // module.exports

// --------------------------------------------------------------------------------
// --------------------------------------------------------------------------------
// --------------------------------------------------------------------------------
// --------------------------------------------------------------------------------
// --------------------------------------------------------------------------------
